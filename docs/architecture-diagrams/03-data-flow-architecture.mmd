graph LR
    subgraph "External Systems"
        HOSPITAL[ğŸ¥ Hospital Systems<br/>HL7/FHIR]
        PACS[ğŸ“¡ PACS System<br/>DICOM Images]
        LAB[ğŸ”¬ Lab Systems<br/>Results]
    end

    subgraph "API Gateway"
        GATEWAY[ğŸšª API Gateway<br/>Authentication<br/>Rate Limiting]
    end

    subgraph "Microservices"
        AUTH_SVC[ğŸ” Auth Service<br/>JWT/OAuth2]
        PATIENT_SVC[ğŸ‘¥ Patient Service<br/>Demographics]
        IMAGE_SVC[ğŸ–¼ï¸ Image Service<br/>DICOM Processing]
        AI_SVC[ğŸ¤– AI Service<br/>Inference Engine]
        REPORT_SVC[ğŸ“Š Report Service<br/>Analytics]
        AUDIT_SVC[ğŸ“ Audit Service<br/>Compliance]
    end

    subgraph "Data Storage"
        PATIENT_DB[(ğŸ‘¥ Patient DB<br/>PostgreSQL)]
        IMAGE_STORE[(ğŸ–¼ï¸ Image Store<br/>S3/MinIO)]
        AUDIT_DB[(ğŸ“ Audit DB<br/>PostgreSQL)]
        CACHE[(âš¡ Redis Cache)]
        SEARCH[(ğŸ” Elasticsearch<br/>Search Index)]
    end

    subgraph "AI/ML Pipeline"
        MODEL_STORE[(ğŸ§  Model Store<br/>MLflow)]
        INFERENCE[âš¡ Inference Engine<br/>ONNX Runtime]
        MONITORING[ğŸ“ˆ ML Monitoring<br/>Model Drift]
    end

    %% External connections
    HOSPITAL --> GATEWAY
    PACS --> GATEWAY
    LAB --> GATEWAY

    %% Gateway routing
    GATEWAY --> AUTH_SVC
    GATEWAY --> PATIENT_SVC
    GATEWAY --> IMAGE_SVC
    GATEWAY --> AI_SVC
    GATEWAY --> REPORT_SVC

    %% Service dependencies
    PATIENT_SVC --> PATIENT_DB
    PATIENT_SVC --> CACHE
    IMAGE_SVC --> IMAGE_STORE
    AI_SVC --> INFERENCE
    AI_SVC --> MODEL_STORE
    REPORT_SVC --> PATIENT_DB
    REPORT_SVC --> SEARCH
    AUTH_SVC --> CACHE
    AUDIT_SVC --> AUDIT_DB

    %% ML pipeline
    INFERENCE --> MODEL_STORE
    INFERENCE --> MONITORING
    AI_SVC --> AUDIT_SVC

    style GATEWAY fill:#e1f5fe,stroke:#01579b
    style AI_SVC fill:#f3e5f5,stroke:#7b1fa2
    style INFERENCE fill:#e8f5e8,stroke:#2e7d32
